<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Lecture 4</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="container">
          <div class="site">
            <div class="header">
              <h1 class="title"><a href="/">Design Patterns</a></h1>
              <a class="extra" href="/">home</a>
            </div>

                <h2>Lecture 4</h2>
<p class="meta">28 Aug 2013</p>

<div class="post">
<h1 id="toc_0">DP Background</h1>

<h2 id="toc_1">How to choose DPs</h2>

<ol>
<li>Consider how DPs  solve design problems</li>
<li>scan the intents section</li>
<li>study how patterns interrelate</li>
<li>study patters of like purpose</li>
<li>examine causes of redesign</li>
<li>consider what should be variable in your design</li>
</ol>

<h2 id="toc_2">[ Aspects That vary ]</h2>

<h2 id="toc_3">How to use DPs</h2>

<ol>
<li>read the pattern once through for an overview</li>
<li>fo back and study the <em>Structure, Participants, &amp; Collaborations</em> secions</li>
<li>look at the source code section to see concrete implementations</li>
<li>choose name for the pattern participants that are menaing in your application content</li>
<li>design classes and interfaces [ not implement - that&#39;s later] </li>
<li>define application specifc names for the operations in the patterns</li>
<li>implement those operations to carry out the responsibilities &amp; collaborations<br></li>
</ol>

<h1 id="toc_4">Warning! Danger!</h1>

<p>Design patterns should not be applied indiscriminately. Often they acieve flexibility by introducing additional levels of indirection and that can complicate your design
and/or cost you some performance.</p>

<p>A design pattern should only be applied when the flexibility it affords is actually needed.</p>

<h1 id="toc_5">Factory Method (107)</h1>

<h2 id="toc_6">Intent</h2>

<p>Define an interface for creating an object, but let subclasses decide which class to inistantiate. FM lets a class defer instantiation to subclasses.  </p>

<p><em>idea</em>: avoid dependencies on a particular class by avoiding direct call to a constructor;
instead, we want to promote dependency on a type.  </p>

<p>(AKA) Virtual Constructor - in C++ and Java, constructors are not methods and cannot be overridden. In C++, the keyword virtual is used to indicate that a method can be overridden. The pattern allows us to effectively &quot;fake&quot; an overridable constructor</p>

<h2 id="toc_7">Excersie</h2>

<p>Q: Name to common used java methods that return an object<br>
A: toString() clone()</p>

<h2 id="toc_8">Overview</h2>

<p>In order to be a FM, the method must:  </p>

<ol>
<li>return a new object</li>
<li>return an instance of a type

<ul>
<li>i.e., something multiple classes might implement</li>
</ul></li>
<li>[ could ultimately be ] implmented by several classes</li>
</ol>

<h3 id="toc_9">Case study: Java</h3>

<p>Consider the following Java entities:</p>

<div class="highlight"><pre><code class="java"><span class="kd">class</span> <span class="nc">javax</span><span class="o">.</span><span class="na">swing</span><span class="o">.</span><span class="na">BorderFactory</span>
<span class="c1">//Factory class for vending standard object borders</span>
<span class="c1">//whenever possible this factory will handout reference to shared border instances</span>

<span class="kd">class</span> <span class="nc">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">Array</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">method</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">asList</span><span class="o">(</span><span class="n">T</span> <span class="o">...</span> <span class="n">a</span><span class="o">)</span>
<span class="c1">// Returns a fixes size list, backed by the specified array</span>

<span class="kd">interface</span> <span class="nc">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">Iterable</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">operation</span> <span class="n">Iterator</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">iterator</span><span class="o">()</span>
<span class="c1">// returns an iterator over a set of elements of type T</span>

<span class="kd">class</span> <span class="nc">Object</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">method</span> <span class="n">String</span> <span class="n">toString</span><span class="o">()</span>
<span class="c1">//returns a string representation of an object</span>

<span class="n">BorderFactory</span><span class="o">.</span><span class="na">createEtchedBorder</span><span class="o">()</span>
<span class="n">Array</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">T</span> <span class="o">...</span> <span class="n">a</span><span class="o">)</span>
<span class="n">foo</span><span class="o">.</span><span class="na">toString</span><span class="o">()</span>
<span class="n">collection</span><span class="o">.</span><span class="na">iterator</span><span class="o">()</span>
<span class="c1">// Returns </span>
</code></pre></div>

<hr>

<h1 id="toc_10">Comparison</h1>

<table><thead>
<tr>
<th><em>Methods</em></th>
<th>Returns new Object</th>
<th>returns an instance of a type</th>
<th>implmented by subclasses</th>
</tr>
</thead><tbody>
<tr>
<td>BorderFactory.createEtchedBorder()</td>
<td>?</td>
<td>✓</td>
<td>?</td>
</tr>
<tr>
<td>Array.asList(T ... a)</td>
<td>✓</td>
<td>✓</td>
<td>X</td>
</tr>
<tr>
<td>foo.toString()</td>
<td>✓</td>
<td>X</td>
<td>✓</td>
</tr>
<tr>
<td>collection.iterator</td>
<td>✓</td>
<td>✓</td>
<td>✓</td>
</tr>
</tbody></table>

<h1 id="toc_11">HW 01</h1>

<ol>
<li><p>explain how the intent of the factory method differs from the intent of the border factory method
(100 min, 400 max) <em>remember the deliverables format)</em>   </p></li>
<li><p>In your own words [200,400], <em>how does FM promote loose coupling?</em>  </p></li>
<li><p>Consider String representing names in the form
&quot;First Last&quot;
&quot;Last, First&quot; &lt;- note the comma</p>

<p>&quot;Assume an operation Name makeName(String name) which returns</p></li>
</ol>

<table><thead>
<tr>
<th>Name</th>
</tr>
</thead><tbody>
<tr>
<td>-first:String</td>
</tr>
<tr>
<td>-last:String</td>
</tr>
</tbody></table>

<p>with the fields correctly initialized with either form on String.</p>

<p><em>Is this an example of FM</em> [200, 400] words?</p>

<p><strong>Due: next class</strong></p>

<h1 id="toc_12">Implementation</h1>

<h2 id="toc_13">1. GoF canonincal</h2>

<p>There are two major variations  </p>

<ul>
<li>The Creator provides a <em>default implementation</em> (which may be overridden)</li>
</ul>

<div class="highlight"><pre><code class="java"><span class="kd">public</span> <span class="n">Product</span> <span class="nf">makeProduct</span><span class="o">(){</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nf">DefaultProduct</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div>

<p>this style is usefule when there is a resonable choice for a default product class. 
<em>Note:</em> in this case, the <strong>Creator</strong> need not be an abstract class.</p>

<ul>
<li>the <strong>Creator</strong> is abstract and declares an abstract method<br>
<code>abstract public Product makeProduct();</code> </li>
</ul>

<p>in this case, <strong>ConcreteCreators</strong> <em>must</em> implement the FM
Note: this is the preferred style when there is not a reasonable defualt product</p>

<hr>

<h2 id="toc_14">2. Parameterized Factory (aka, Simple Factor)</h2>

<p>Note: there are many who believe this is nat an example of FM. It is often called Simple Factory, especially by the non-believers</p>

<p>A <em>single</em> PFM (or SF) can create and return instance of many <strong>ConcreteProduct</strong> classes;
the class of the object returned i sbased on the actual parameter supllied.  </p>

<ul>
<li>Creator implements PFM</li>
</ul>

<div class="highlight"><pre><code class="java">    <span class="kd">public</span> <span class="n">Product</span> <span class="nf">makeProduct</span><span class="o">(</span><span class="n">TypeCode</span> <span class="n">type</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="n">type</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">Type</span> <span class="n">A</span><span class="o">)</span> <span class="k">return</span> <span class="k">new</span> <span class="n">ProductTypeA</span><span class="o">();</span>
        <span class="k">if</span> <span class="n">type</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">Type</span> <span class="n">B</span><span class="o">)</span> <span class="k">return</span> <span class="k">new</span> <span class="n">ProductTypeB</span><span class="o">();</span>

        <span class="k">throw</span> <span class="k">new</span> <span class="nf">NoSuchProductException</span><span class="o">(</span><span class="n">type</span><span class="o">);</span>
    <span class="o">}</span>
</code></pre></div>

<ul>
<li>subCreator re-implement PFM</li>
</ul>

<div class="highlight"><pre><code class="java">    <span class="kd">public</span> <span class="n">Product</span> <span class="nf">makeProduct</span><span class="o">(</span><span class="n">TypeCode</span> <span class="n">type</span><span class="o">){</span>
        <span class="k">if</span> <span class="n">type</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">Type</span> <span class="n">A</span><span class="o">)</span> <span class="k">return</span> <span class="k">new</span> <span class="n">ProductTypeA2</span><span class="o">();</span>
        <span class="k">if</span> <span class="n">type</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">Type</span> <span class="n">C</span><span class="o">)</span> <span class="k">return</span> <span class="k">new</span> <span class="n">ProductTypeC</span><span class="o">();</span>

        <span class="k">return</span> <span class="kd">super</span><span class="o">.</span><span class="na">makeProduct</span><span class="o">(</span> <span class="n">type</span> <span class="o">);</span>
    <span class="o">}</span>
</code></pre></div>

<hr>

<h2 id="toc_15">Discussion of PFM</h2>

<ul>
<li>The <strong>SubCreator</strong> can override the <strong>CProduct</strong> for a given TypeCode that is <em>always</em> being handled by the <strong>Creator</strong>.
This can lead to confusion, or be really cool, depending on your perspective.</li>
<li>Use of a <strong>TypeCode</strong> - especially when implemented as a <code>String</code> or <code>int</code> - can easily avoid the compiler&#39;s type checking mechanism
and thus allow bugs to pass unnoticed that would have been caught</li>
<li>Unless there is some meaningful type common to all the <strong>CProduct</strong> classes, then the return type devolves to <code>Product == Object</code>,
which forces the <em>caller</em> to know the <em>actual</em> type returned fora  particular TypeCode, so that the caller can cast 
(or otherwise treat the object preferentially) to it&#39;s actual type [as <strong>Object</strong> doesn&#39;t declare many &quot;interesting&quot; methods]</li>
</ul>

<p>(Also true for FM)<br>
* The Creator is typically the FM&#39;s client! The <strong>Creator</strong> almsot always contains code that called the  (P)FM. 
 Specific <strong>Creators</strong> are usually meant to work with specific <strong>CProducts</strong> - which is <em>why</em> the FM is overridden by the <strong>CCreator</strong> class.<br>
   * something</p>

</div>


            <div class="footer">
              <div class="contact">
                <p>
                  Your Name<br />
                  What You Are<br />
                  your@email.com
                </p>
              </div>
              <div class="contact">
                <p>
                  <a href="http://github.com/yourusername/">github.com/yourusername</a><br />
                  <a href="http://twitter.com/yourusername/">twitter.com/yourusername</a><br />
                </p>
              </div>
            </div>
          </div>
        </div> <!-- /container -->

    </body>
</html>
